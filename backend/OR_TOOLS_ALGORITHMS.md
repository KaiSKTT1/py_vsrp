# üî¨ THU·∫¨T TO√ÅN OR-TOOLS S·ª¨ D·ª§NG TRONG CODE

## üìå T√ìM T·∫ÆT NHANH

OR-Tools **KH√îNG d√πng 1 thu·∫≠t to√°n duy nh·∫•t** m√† l√† **k·∫øt h·ª£p nhi·ªÅu thu·∫≠t to√°n** (hybrid approach):

1. **First Solution Strategy** (Heuristic) ‚Üí T√¨m nghi·ªám ban ƒë·∫ßu
2. **Local Search** (Metaheuristic) ‚Üí C·∫£i thi·ªán nghi·ªám
3. **Constraint Propagation** ‚Üí Lo·∫°i b·ªè nghi·ªám kh√¥ng h·ª£p l·ªá
4. **Branch and Bound** (Optional) ‚Üí T√¨m nghi·ªám t·ªëi ∆∞u h∆°n

---

## üéØ CH·ªà RA TRONG CODE

### 1Ô∏è‚É£ **V·ªã tr√≠ khai b√°o thu·∫≠t to√°n ch√≠nh**

```python
# File: cvrp_solver_api.py, d√≤ng 98-100

search_params = pywrapcp.DefaultRoutingSearchParameters()
search_params.first_solution_strategy = strategy  # ‚Üê ƒê√ÇY: Ch·ªçn thu·∫≠t to√°n t√¨m nghi·ªám ban ƒë·∫ßu
search_params.time_limit.seconds = time_limit_s
```

**Gi·∫£i th√≠ch:**
- `first_solution_strategy` = Thu·∫≠t to√°n **HEURISTIC** ƒë·ªÉ t√¨m nghi·ªám kh·∫£ thi ƒë·∫ßu ti√™n
- Gi√° tr·ªã `strategy` ƒë∆∞·ª£c truy·ªÅn v√†o t·ª´ attempts (d√≤ng 178-183)

---

### 2Ô∏è‚É£ **C√°c thu·∫≠t to√°n ƒë∆∞·ª£c s·ª≠ d·ª•ng trong code**

```python
# File: cvrp_solver_api.py, d√≤ng 171-176

strategies = [
    ("PATH_CHEAPEST_ARC", routing_enums_pb2.FirstSolutionStrategy.PATH_CHEAPEST_ARC),  # ‚Üê Thu·∫≠t to√°n 1
    ("PARALLEL_CHEAPEST_INSERTION", routing_enums_pb2.FirstSolutionStrategy.PARALLEL_CHEAPEST_INSERTION),  # ‚Üê Thu·∫≠t to√°n 2
    ("LOCAL_CHEAPEST_INSERTION", routing_enums_pb2.FirstSolutionStrategy.LOCAL_CHEAPEST_INSERTION),  # ‚Üê Thu·∫≠t to√°n 3
    ("GLOBAL_CHEAPEST_ARC", routing_enums_pb2.FirstSolutionStrategy.GLOBAL_CHEAPEST_ARC),  # ‚Üê Thu·∫≠t to√°n 4
]
```

**4 thu·∫≠t to√°n heuristic ƒë∆∞·ª£c d√πng:**
1. PATH_CHEAPEST_ARC
2. PARALLEL_CHEAPEST_INSERTION
3. LOCAL_CHEAPEST_INSERTION
4. GLOBAL_CHEAPEST_ARC

---

### 3Ô∏è‚É£ **N∆°i g·ªçi solver (k·∫øt h·ª£p nhi·ªÅu thu·∫≠t to√°n)**

```python
# File: cvrp_solver_api.py, d√≤ng 102

solution = routing.SolveWithParameters(search_params)  # ‚Üê ƒê√ÇY: Ch·∫°y solver
```

**B√™n trong `SolveWithParameters()` OR-Tools l√†m g√¨:**
1. Ch·∫°y First Solution Strategy (heuristic)
2. √Åp d·ª•ng Local Search ƒë·ªÉ c·∫£i thi·ªán
3. Ki·ªÉm tra constraints (capacity, time limit)
4. Tr·∫£ v·ªÅ nghi·ªám t·ªët nh·∫•t t√¨m ƒë∆∞·ª£c

---

## üìö CHI TI·∫æT C√ÅC THU·∫¨T TO√ÅN

### üîµ 1. PATH_CHEAPEST_ARC (Greedy Algorithm)

**T√™n ƒë·∫ßy ƒë·ªß:** Path Cheapest Arc Heuristic

**C√°ch ho·∫°t ƒë·ªông:**
```
B∆∞·ªõc 1: B·∫Øt ƒë·∫ßu t·ª´ depot (ƒëi·ªÉm 0)
B∆∞·ªõc 2: T·∫°i m·ªói b∆∞·ªõc, ch·ªçn c·∫°nh (arc) R·∫∫ NH·∫§T ch∆∞a ƒë∆∞·ª£c s·ª≠ d·ª•ng
B∆∞·ªõc 3: Th√™m v√†o route hi·ªán t·∫°i (n·∫øu kh√¥ng vi ph·∫°m capacity)
B∆∞·ªõc 4: L·∫∑p l·∫°i cho ƒë·∫øn khi h·∫øt ƒëi·ªÉm
```

**V√≠ d·ª• minh h·ªça:**
```
Depot = 0, ƒêi·ªÉm = [1, 2, 3]
Kho·∫£ng c√°ch:
  0‚Üí1: 10km
  0‚Üí2: 15km
  0‚Üí3: 8km   ‚Üê R·∫∫ NH·∫§T
  
B∆∞·ªõc 1: Ch·ªçn 0‚Üí3 (8km)
B∆∞·ªõc 2: T·ª´ 3, ch·ªçn 3‚Üí1 (6km) ‚Üê r·∫ª nh·∫•t t·ª´ 3
B∆∞·ªõc 3: T·ª´ 1, ch·ªçn 1‚Üí2 (5km)
B∆∞·ªõc 4: Quay v·ªÅ 2‚Üí0 (15km)

Route: [0, 3, 1, 2, 0]
```

**Ph√¢n lo·∫°i thu·∫≠t to√°n:**
- ‚úÖ **Greedy Algorithm** (Tham lam)
- ‚úÖ Complexity: O(n¬≤)
- ‚ùå Kh√¥ng ƒë·∫£m b·∫£o t·ªëi ∆∞u to√†n c·ª•c

**Ch·ªâ ra trong code:**
```python
# D√≤ng 178
(vehicle_count, time_limit_s, strategies[0][0], strategies[0][1]),
# strategies[0][1] = routing_enums_pb2.FirstSolutionStrategy.PATH_CHEAPEST_ARC
```

---

### üü¢ 2. PARALLEL_CHEAPEST_INSERTION (Parallel Insertion Heuristic)

**T√™n ƒë·∫ßy ƒë·ªß:** Parallel Cheapest Insertion Heuristic

**C√°ch ho·∫°t ƒë·ªông:**
```
B∆∞·ªõc 1: T·∫°o route r·ªóng cho T·∫§T C·∫¢ c√°c xe
B∆∞·ªõc 2: V·ªõi m·ªói ƒëi·ªÉm ch∆∞a ƒë∆∞·ª£c ph√¢n:
   - T√≠nh chi ph√≠ CH√àN v√†o m·ªói route (·ªü m·ªçi v·ªã tr√≠)
   - Ch·ªçn route + v·ªã tr√≠ c√≥ chi ph√≠ th·∫•p nh·∫•t
   - Ch√®n ƒëi·ªÉm v√†o
B∆∞·ªõc 3: L·∫∑p cho ƒë·∫øn h·∫øt ƒëi·ªÉm
```

**V√≠ d·ª• minh h·ªça:**
```
3 xe, 6 ƒëi·ªÉm [1,2,3,4,5,6]

Ban ƒë·∫ßu:
  Xe 1: [0, _, 0]
  Xe 2: [0, _, 0]
  Xe 3: [0, _, 0]

ƒêi·ªÉm 1: T√≠nh chi ph√≠ ch√®n v√†o 3 route
  Xe 1: [0, 1, 0] ‚Üí chi ph√≠ +20km
  Xe 2: [0, 1, 0] ‚Üí chi ph√≠ +22km
  Xe 3: [0, 1, 0] ‚Üí chi ph√≠ +18km ‚Üê R·∫∫ NH·∫§T
  ‚Üí Ch·ªçn Xe 3

ƒêi·ªÉm 2: T√≠nh l·∫°i
  Xe 1: [0, 2, 0] ‚Üí +25km
  Xe 2: [0, 2, 0] ‚Üí +20km ‚Üê R·∫∫ NH·∫§T
  Xe 3: [0, 1, 2, 0] ‚Üí +15km nh∆∞ng v·ªã tr√≠ [0,2,1,0] ‚Üí +16km
  ‚Üí Ch·ªçn Xe 2

...
```

**Ph√¢n lo·∫°i thu·∫≠t to√°n:**
- ‚úÖ **Insertion Heuristic** (Ch√®n)
- ‚úÖ Complexity: O(n¬≤ √ó k) v·ªõi k = s·ªë xe
- ‚úÖ C√¢n b·∫±ng t·∫£i t·ªët
- ‚ùå Ch·∫≠m h∆°n PATH_CHEAPEST_ARC

**Ch·ªâ ra trong code:**
```python
# D√≤ng 180
(int(vehicle_count * 0.95), time_limit_s * 2, strategies[1][0], strategies[1][1]),
# strategies[1][1] = routing_enums_pb2.FirstSolutionStrategy.PARALLEL_CHEAPEST_INSERTION
```

---

### üü° 3. LOCAL_CHEAPEST_INSERTION (Sequential Insertion Heuristic)

**T√™n ƒë·∫ßy ƒë·ªß:** Local Cheapest Insertion Heuristic

**C√°ch ho·∫°t ƒë·ªông:**
```
B∆∞·ªõc 1: T·∫°o route cho xe ƒë·∫ßu ti√™n
B∆∞·ªõc 2: Ch√®n c√°c ƒëi·ªÉm v√†o route n√†y cho ƒë·∫øn khi ƒë·∫ßy capacity
B∆∞·ªõc 3: Chuy·ªÉn sang xe ti·∫øp theo
B∆∞·ªõc 4: L·∫∑p l·∫°i
```

**V√≠ d·ª• minh h·ªça:**
```
Capacity = 100, Demand = [0, 30, 40, 50, 20, 30]

Xe 1:
  - Th√™m ƒëi·ªÉm 1 (30) ‚Üí load = 30
  - Th√™m ƒëi·ªÉm 2 (40) ‚Üí load = 70
  - Th√™m ƒëi·ªÉm 4 (20) ‚Üí load = 90
  - Kh√¥ng th·ªÉ th√™m ƒëi·ªÉm 3 (50) ‚Üí v∆∞·ª£t capacity
  ‚Üí Route: [0, 1, 2, 4, 0]

Xe 2:
  - Th√™m ƒëi·ªÉm 3 (50) ‚Üí load = 50
  - Th√™m ƒëi·ªÉm 5 (30) ‚Üí load = 80
  ‚Üí Route: [0, 3, 5, 0]
```

**Ph√¢n lo·∫°i thu·∫≠t to√°n:**
- ‚úÖ **Sequential Insertion Heuristic** (Ch√®n tu·∫ßn t·ª±)
- ‚úÖ Complexity: O(n¬≤)
- ‚úÖ Nhanh
- ‚ùå Kh√¥ng c√¢n b·∫±ng t·∫£i

**Ch·ªâ ra trong code:**
```python
# D√≤ng 181
(int(vehicle_count * 1.1), time_limit_s, strategies[2][0], strategies[2][1]),
# strategies[2][1] = routing_enums_pb2.FirstSolutionStrategy.LOCAL_CHEAPEST_INSERTION
```

---

### üî¥ 4. GLOBAL_CHEAPEST_ARC (Global Greedy)

**T√™n ƒë·∫ßy ƒë·ªß:** Global Cheapest Arc Heuristic

**C√°ch ho·∫°t ƒë·ªông:**
```
B∆∞·ªõc 1: Xem x√©t T·∫§T C·∫¢ c√°c c·∫°nh trong to√†n b·ªô graph
B∆∞·ªõc 2: Ch·ªçn c·∫°nh R·∫∫ NH·∫§T to√†n c·ª•c (ch∆∞a d√πng)
B∆∞·ªõc 3: Th√™m v√†o route ph√π h·ª£p
B∆∞·ªõc 4: T√≠nh to√°n l·∫°i t·∫•t c·∫£ c√°c c·∫°nh
B∆∞·ªõc 5: L·∫∑p l·∫°i
```

**V√≠ d·ª• minh h·ªça:**
```
T·∫•t c·∫£ c·∫°nh:
  0‚Üí1: 10km
  0‚Üí2: 15km
  0‚Üí3: 8km
  1‚Üí2: 5km  ‚Üê R·∫∫ NH·∫§T TO√ÄN C·ª§C
  1‚Üí3: 6km
  2‚Üí3: 7km

B∆∞·ªõc 1: Ch·ªçn 1‚Üí2 (5km) ‚Üí T·∫°o route [1, 2]
B∆∞·ªõc 2: T√≠nh l·∫°i, ch·ªçn 0‚Üí3 (8km) ‚Üê r·∫ª nh·∫•t c√≤n l·∫°i
B∆∞·ªõc 3: K·∫øt n·ªëi: [0, 3, ...] v√† [..., 1, 2]
B∆∞·ªõc 4: T√¨m c√°ch n·ªëi 3‚Üí1 (6km)
‚Üí Route: [0, 3, 1, 2, 0]
```

**Ph√¢n lo·∫°i thu·∫≠t to√°n:**
- ‚úÖ **Global Greedy Algorithm** (Tham lam to√†n c·ª•c)
- ‚úÖ Cho nghi·ªám t·ªët nh·∫•t
- ‚ùå Ch·∫≠m nh·∫•t: O(n¬≤ log n)
- ‚ùå T·ªën nhi·ªÅu b·ªô nh·ªõ

**Ch·ªâ ra trong code:**
```python
# D√≤ng 182
(vehicle_count, time_limit_s * 3, strategies[3][0], strategies[3][1]),
# strategies[3][1] = routing_enums_pb2.FirstSolutionStrategy.GLOBAL_CHEAPEST_ARC
```

---

## üîÑ THU·∫¨T TO√ÅN B·ªî SUNG (Implicit trong OR-Tools)

### 5Ô∏è‚É£ **Local Search (Metaheuristic)**

**Kh√¥ng hi·ªán r√µ trong code nh∆∞ng OR-Tools T·ª± ƒë·ªông √°p d·ª•ng sau First Solution**

```python
# Sau d√≤ng 102: solution = routing.SolveWithParameters(search_params)
# OR-Tools t·ª± ƒë·ªông ch·∫°y Local Search
```

**C√°c k·ªπ thu·∫≠t Local Search OR-Tools s·ª≠ d·ª•ng:**

#### **a) 2-opt (Two-Opt Exchange)**
```
Route ban ƒë·∫ßu: [0, 1, 2, 3, 4, 0]

Th·ª≠ swap 2 c·∫°nh:
  X√≥a: 1‚Üí2 v√† 3‚Üí4
  Th√™m: 1‚Üí3 v√† 2‚Üí4
  
Route m·ªõi: [0, 1, 3, 2, 4, 0]

N·∫øu t·ªët h∆°n ‚Üí gi·ªØ l·∫°i
```

#### **b) Relocate (Di chuy·ªÉn 1 ƒëi·ªÉm)**
```
Route 1: [0, 1, 2, 3, 0]
Route 2: [0, 4, 5, 0]

Di chuy·ªÉn ƒëi·ªÉm 2 t·ª´ Route 1 sang Route 2:
Route 1: [0, 1, 3, 0]
Route 2: [0, 4, 2, 5, 0]

N·∫øu t·ªïng distance gi·∫£m ‚Üí ch·∫•p nh·∫≠n
```

#### **c) Exchange (ƒê·ªïi ch·ªó 2 ƒëi·ªÉm)**
```
Route 1: [0, 1, 2, 0]
Route 2: [0, 3, 4, 0]

ƒê·ªïi ƒëi·ªÉm 2 v√† ƒëi·ªÉm 3:
Route 1: [0, 1, 3, 0]
Route 2: [0, 2, 4, 0]
```

#### **d) Cross (Cross-exchange)**
```
Route 1: [0, 1, 2, 3, 0]
Route 2: [0, 4, 5, 6, 0]

Cross after 2 and 5:
Route 1: [0, 1, 2, 5, 6, 0]
Route 2: [0, 4, 3, 0]
```

**Ch·ªâ ra trong code:**
```python
# OR-Tools t·ª± ƒë·ªông √°p d·ª•ng Local Search trong SolveWithParameters()
# Kh√¥ng c·∫ßn code th√™m, n√≥ l√† built-in
```

---

### 6Ô∏è‚É£ **Constraint Propagation**

**V·ªã tr√≠ trong code:**
```python
# D√≤ng 96
routing.AddDimensionWithVehicleCapacity(demand_cb_idx, 0, data["vehicle_capacities"], True, "Capacity")
#                                                        ‚Üë
#                                          CONSTRAINT PROPAGATION ·ªü ƒë√¢y
```

**C√°ch ho·∫°t ƒë·ªông:**
```
B∆∞·ªõc 1: OR-Tools t·∫°o domain (mi·ªÅn gi√° tr·ªã) cho m·ªói bi·∫øn
  - Xe 1 c√≥ th·ªÉ ch·ªü ƒëi·ªÉm [1, 2, 3, 4, 5, 6]
  
B∆∞·ªõc 2: √Åp d·ª•ng constraint (capacity)
  - N·∫øu Xe 1 ƒë√£ c√≥ [1, 2] v·ªõi load=70
  - ƒêi·ªÉm 3 c√≥ demand=50 ‚Üí 70+50=120 > capacity(100)
  - ‚Üí Lo·∫°i ƒëi·ªÉm 3 kh·ªèi domain c·ªßa Xe 1
  
B∆∞·ªõc 3: Propagate (lan truy·ªÅn)
  - N·∫øu ch·ªâ Xe 2 c√≥ th·ªÉ ch·ªü ƒëi·ªÉm 3
  - ‚Üí Xe 2 PH·∫¢I ch·ªü ƒëi·ªÉm 3
  - ‚Üí Domain c·ªßa Xe 2 thu nh·ªè
```

**V√≠ d·ª•:**
```
Capacity = 100
ƒêi·ªÉm 1: demand=40
ƒêi·ªÉm 2: demand=50
ƒêi·ªÉm 3: demand=60

Constraint:
  Xe kh√¥ng th·ªÉ ch·ªü c·∫£ [1, 2, 3] v√¨ 40+50+60=150 > 100
  
Propagation:
  N·∫øu Xe 1 ch·ªü [1, 2] ‚Üí load=90
  ‚Üí ƒêi·ªÉm 3 PH·∫¢I ·ªü Xe kh√°c
```

---

### 7Ô∏è‚É£ **Branch and Bound (Optional)**

**Kh√¥ng b·∫Øt bu·ªôc, OR-Tools c√≥ th·ªÉ d√πng n·∫øu:**
- Time limit ƒë·ªß d√†i
- B√†i to√°n nh·ªè (<30 ƒëi·ªÉm)
- C·∫ßn nghi·ªám t·ªëi ∆∞u ch·ª©ng minh ƒë∆∞·ª£c

**C√°ch ho·∫°t ƒë·ªông:**
```
         [All solutions]
              |
        /-----|-----\
       /      |      \
   Xe1=[1]  Xe1=[2]  Xe1=[3]
     |        |        |
  Bound    Bound    Bound
   120km    150km    110km ‚Üê T·ªët nh·∫•t, ti·∫øp t·ª•c
     |
  Cut branches > 110km
```

**Kh√¥ng hi·ªán r√µ trong code** v√¨ OR-Tools t·ª± quy·∫øt ƒë·ªãnh d√πng hay kh√¥ng.

---

## üìä B·∫¢NG T·ªîNG H·ª¢P C√ÅC THU·∫¨T TO√ÅN

| STT | Thu·∫≠t to√°n | Lo·∫°i | V·ªã tr√≠ trong code | Khi n√†o d√πng |
|-----|-----------|------|-------------------|--------------|
| 1 | PATH_CHEAPEST_ARC | Greedy | D√≤ng 178 | Nhanh, demo |
| 2 | PARALLEL_CHEAPEST_INSERTION | Insertion Heuristic | D√≤ng 180 | C√¢n b·∫±ng t·∫£i |
| 3 | LOCAL_CHEAPEST_INSERTION | Sequential Insertion | D√≤ng 181 | D·ªØ li·ªáu c√≥ cluster |
| 4 | GLOBAL_CHEAPEST_ARC | Global Greedy | D√≤ng 182 | Nghi·ªám t·ªët nh·∫•t |
| 5 | Local Search (2-opt, Relocate, Exchange) | Metaheuristic | T·ª± ƒë·ªông trong `SolveWithParameters()` | Lu√¥n d√πng |
| 6 | Constraint Propagation | Constraint Programming | D√≤ng 96 | Lu√¥n d√πng |
| 7 | Branch and Bound | Exact Algorithm | Optional, t·ª± ƒë·ªông | B√†i nh·ªè, c·∫ßn optimal |

---

## üéØ QUY TR√åNH HO√ÄN CH·ªàNH

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  1. FIRST SOLUTION STRATEGY         ‚îÇ
‚îÇ  (Heuristic: PATH/PARALLEL/...)     ‚îÇ
‚îÇ  ‚Üí T√¨m nghi·ªám kh·∫£ thi ban ƒë·∫ßu       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  2. CONSTRAINT PROPAGATION          ‚îÇ
‚îÇ  ‚Üí Lo·∫°i b·ªè nghi·ªám vi ph·∫°m capacity  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  3. LOCAL SEARCH                    ‚îÇ
‚îÇ  (2-opt, Relocate, Exchange, ...)   ‚îÇ
‚îÇ  ‚Üí C·∫£i thi·ªán nghi·ªám                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  4. BRANCH AND BOUND (optional)     ‚îÇ
‚îÇ  ‚Üí T√¨m nghi·ªám t·ªëi ∆∞u h∆°n            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
      [Return Best Solution]
```

---

## üí° V√ç D·ª§ TH·ª∞C T·∫æ: OR-TOOLS CH·∫†Y NH∆Ø TH·∫æ N√ÄO

### Input:
```
5 ƒëi·ªÉm [1,2,3,4,5]
2 xe, capacity=100
Demand: [0, 30, 40, 50, 20, 30]
Strategy: PARALLEL_CHEAPEST_INSERTION
```

### B∆∞·ªõc 1: First Solution (PARALLEL_CHEAPEST_INSERTION)
```
Iteration 1: Ch√®n ƒëi·ªÉm 1 (demand=30)
  Xe 1: [0, 1, 0] cost=20
  Xe 2: [0, 1, 0] cost=25
  ‚Üí Ch·ªçn Xe 1

Iteration 2: Ch√®n ƒëi·ªÉm 2 (demand=40)
  Xe 1: [0, 1, 2, 0] cost=+18
  Xe 2: [0, 2, 0] cost=+22
  ‚Üí Ch·ªçn Xe 1, load=70

Iteration 3: Ch√®n ƒëi·ªÉm 3 (demand=50)
  Xe 1: [0, 1, 2, 3, 0] ‚Üí load=120 > 100 ‚ùå VI PH·∫†M
  Xe 2: [0, 3, 0] cost=+30
  ‚Üí Ch·ªçn Xe 2

...

Nghi·ªám ban ƒë·∫ßu:
  Xe 1: [0, 1, 2, 4, 0] load=90
  Xe 2: [0, 3, 5, 0] load=80
  Total: 120km
```

### B∆∞·ªõc 2: Constraint Propagation
```
Ki·ªÉm tra:
  Xe 1 load=90 ‚â§ 100 ‚úì
  Xe 2 load=80 ‚â§ 100 ‚úì
  T·∫•t c·∫£ ƒëi·ªÉm ƒë√£ gh√© ‚úì
‚Üí Nghi·ªám h·ª£p l·ªá
```

### B∆∞·ªõc 3: Local Search (2-opt)
```
Th·ª≠ swap:
  [0, 1, 2, 4, 0] ‚Üí [0, 1, 4, 2, 0]
  Distance: 120km ‚Üí 115km ‚úì T·ªët h∆°n!

Th·ª≠ Relocate:
  Di chuy·ªÉn ƒëi·ªÉm 4 t·ª´ Xe 1 sang Xe 2
  Xe 1: [0, 1, 2, 0] load=70
  Xe 2: [0, 3, 4, 5, 0] load=100
  Distance: 115km ‚Üí 110km ‚úì T·ªët h∆°n!

Th·ª≠ Exchange:
  ƒê·ªïi ƒëi·ªÉm 2 v√† 3
  Xe 1: [0, 1, 3, 0]
  Xe 2: [0, 2, 4, 5, 0]
  Distance: 110km ‚Üí 125km ‚úó T·ªá h∆°n, b·ªè

Kh√¥ng c√≤n c·∫£i thi·ªán ‚Üí D·ª´ng
```

### K·∫øt qu·∫£ cu·ªëi:
```
Xe 1: [0, 1, 2, 0]
Xe 2: [0, 3, 4, 5, 0]
Total: 110km
```

---

## üîç DEBUGGING: XEM OR-TOOLS ƒêANG D√ôNG THU·∫¨T TO√ÅN N√ÄO

### Th√™m logging v√†o code:

```python
# Th√™m v√†o solve_cvrp_with_config()

search_params = pywrapcp.DefaultRoutingSearchParameters()
search_params.first_solution_strategy = strategy
search_params.time_limit.seconds = time_limit_s

# ‚Üì‚Üì‚Üì TH√äM LOGGING ‚Üì‚Üì‚Üì
print(f"üîß ƒêang d√πng strategy: {strategy}")
print(f"‚è±Ô∏è  Time limit: {time_limit_s}s")

# B·∫≠t log chi ti·∫øt (optional)
search_params.log_search = True  # ‚Üê Th√™m d√≤ng n√†y ƒë·ªÉ xem log ƒë·∫ßy ƒë·ªß

solution = routing.SolveWithParameters(search_params)
```

### Output s·∫Ω c√≥ d·∫°ng:
```
üîß ƒêang d√πng strategy: 4 (PATH_CHEAPEST_ARC)
‚è±Ô∏è  Time limit: 60s

OR-Tools internal log:
  Starting FIRST_SOLUTION with PATH_CHEAPEST_ARC
  Found initial solution: 5 routes, 156km
  Starting LOCAL_SEARCH
    Iteration 1: 2-opt improved to 148km
    Iteration 2: Relocate improved to 145km
    Iteration 3: No improvement
  LOCAL_SEARCH finished
  
‚úÖ Solution found: 145km
```

---

## üéì K·∫æT LU·∫¨N

### OR-Tools KH√îNG d√πng 1 thu·∫≠t to√°n m√† d√πng HYBRID:

1. **First Solution:** PATH_CHEAPEST_ARC / PARALLEL_CHEAPEST_INSERTION / LOCAL_CHEAPEST_INSERTION / GLOBAL_CHEAPEST_ARC
   - ‚úÖ V·ªã tr√≠: D√≤ng 98, 171-183
   
2. **Constraint Propagation:** Lo·∫°i b·ªè nghi·ªám vi ph·∫°m
   - ‚úÖ V·ªã tr√≠: D√≤ng 96
   
3. **Local Search:** 2-opt, Relocate, Exchange, Cross
   - ‚úÖ T·ª± ƒë·ªông trong `SolveWithParameters()`
   
4. **Branch and Bound:** (Optional)
   - ‚úÖ OR-Tools t·ª± quy·∫øt ƒë·ªãnh

### Ph√¢n lo·∫°i theo l√Ω thuy·∫øt thu·∫≠t to√°n:
- **Greedy:** PATH_CHEAPEST_ARC, GLOBAL_CHEAPEST_ARC
- **Heuristic:** PARALLEL/LOCAL_CHEAPEST_INSERTION
- **Metaheuristic:** Local Search (2-opt, ...)
- **Exact (optional):** Branch and Bound
- **Constraint Programming:** Constraint Propagation

---

**üìù T√≥m l·∫°i:** Code c·ªßa b·∫°n d√πng **4 thu·∫≠t to√°n heuristic kh√°c nhau** (PATH, PARALLEL, LOCAL, GLOBAL) k·∫øt h·ª£p v·ªõi **Local Search t·ª± ƒë·ªông** ƒë·ªÉ t√¨m nghi·ªám g·∫ßn t·ªëi ∆∞u cho b√†i to√°n CVRP.
